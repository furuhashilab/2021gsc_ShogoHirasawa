> ## 青山学院大学 地球社会共生学部 地球社会共生学科

平澤彰悟/ HIRASAWA SHOGO

学生番号 1A117134

指導教員 古橋大地 教授

©︎Furuhashi Laboratory/SHOGO HIRASAWA, CC BY 4.0

## Introduction:

本研究は、激甚災害時のインターネット接続が無い時に、基礎自治体の災害対策本部等で使用できるウェブ地図システムの構築を目的とする。従来、オフライン環境下での Web 地図を閲覧するためのツールとしてあかりマップや maps.me が存在する。この 2 つのツールは、オンライン時に取得した情報をデバイスにキャッシュとして保存して、オフライン環境で閲覧する点で共通している。キャッシュに依存しているので、デバイスやアプリケーション再起動時にデータが閲覧できなくなる可能性がある。あかりマップは Android 端末のみでのリリースとなっており、iPhone ユーザーは利用できない。また、maps.me はラスタータイルのみで作られており、ベクトルタイルを利用することができない。オフライン環境下でキャッシュやデバイスに左右されずかつ、ベクタータイルとラスタータイルの両方が使えるオフライン地図 Web システムはまだ存在していない。先に示した、課題をクリアするために、オフライン環境下で動くオープンソース・ウェブ地図サーバの開発を行った。国連UNVTの

## Methods:

次の 3 つの工程に分けて実装を行った。1.UNVT Portabl アクセスポイント化 2.タイルデータの制作 3.html ファイルの実装。この章では各工程の実装の手法を紹介する。

- UNVT Portabl アクセスポイント化

Mac と UNVT Portable を Ethernet ケーブルで有線接続している状態で、実装に着手した。最初に以下のパッケージ 5 つ（apatch2、hostapd、dnsmasq、isc-dhcp-server、rng-tools）をインストールし、その後に UNVT Portable の IP アドレスの固定化、Wi-Fi の SSID と Pass の設定を行った。QR コード読み取りによる Wi-Fi 接続の簡便化も行い、特別な知識のない人でも、自分の所有する端末を用いて、オフライン環境下でデジタル地図をスマホや PC で閲覧可能とさせた。

- タイルデータの制作

二子玉川駅付近の Web 地図を制作した。本マップを表示するにあたり、次の 4 つのタイルデータ（道路ベクトルタイル・建物ベクトルタイル・二子玉川の空撮ラスタータイル・世田谷区避難所ベクトルタイル）を制作した。道路ベクトルタイル・建物ベクトルタイルは OpenStreetMap、二子玉川の空撮ラスタータイルは OpenAerialMap、世田谷区避難所ベクトルタイルは東京都オープンデータカタログサイトからデータを引用し、それを UNVT にも採用されているオープンソースソフトの Tippicanue で用いてタイル化を行った。

- html ファイルの実装

オフラインで機能する Web 地図アプリケーションを作成するため、MapLibre GL JS を使い実装を行った。上記で記載した、各タイルを Source レイヤーで指定し、道路ベクトルタイル・建物ベクトルタイル・二子玉川の空撮ラスタータイル・世田谷区避難所ベクトルタイルの順で記述し、避難所データが最前面となるよう Layers レイヤーに記述した。避難所のポイントデータは画像としてで表示させた。

## Results:

国連 UNVT 技術をベースに改良を加えたオフライン環境下で動くオープンソース・ウェブ地図サーバーを開発した。現行の UNVT 技術をオフライン環境下で用いるには Ethernet ケーブルによる有線接続が前提であったが、本研究によってこれを Wi-Fi 経由で利用可能にした。UNVT Portable に地域のオープンデータをプリインストールしておくことで、災害時などの停電時などにも行政が設置する災害対策本部などでバックアップウェブ地図システムとして利用できるだけでなく、災害対応で緊急撮影を行ったドローンなどの空撮画像データを重畳することもできる。本研究は激甚災害時のオフライン環境下で動くオープンソース・ウェブ地図サーバーとして開発したが、仕様する地図データの組み合わせを変えることで、他の目的でも利用できる。国連で使用が検討されている PKO の国境監視業務をはじめ、僻地等のオフライン環境下での Web 地図利用が求められる際に UNVT Portable を活用することができる。

## Discussion:

What do your findings mean? あなたが見つけたことは何を意味するのか？どんな議論をしたか。(500 文字以内で簡単に記述する)

## Conclusion:

What have you learned from the study? この研究を通じて得られたものは？次に引き継ぐべき課題は？(500 文字以内で簡単に記述する)
mapbox を用いた Web 地図作成において必要な概念である Sources や Layers を理解するため、Mapbox Style Specification の和訳を行った。
UNVTPortable としての現状の完成度は 80%程であると考える。ウェブ地図サーバーとして機能させるために毎回、コマンド入力が必要なため、コマンド入力を不要にさせ、電源を入れるだけでサーバーとして機能させることがゴールである。併せて、東京都をテキストエリアとして、行政が公開するオープンデータと、ベースマップとしての OpenStreetMap データを組み合わせ、プリインストールデータセットの試作も必要である。上記の課題を踏まえ、今後、国連と連携をとりながら、さらなる開発を進めていく。

## Reference/参考文献:

卒業論文本文中に記載。

## Acknowledgements/謝辞:

本研究を進めるにあたり〇〇〇の〇〇氏をはじめ多くの方々より多大な助言を賜りました。厚く感謝を申し上げます。
